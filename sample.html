<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
<meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
<title>Distributed Name Service</title>
<link href="http://code.google.com/apis/maps/documentation/javascript/examples/default.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
<script type="text/javascript">
var map;
function initialize() {
  var myLatlng = new google.maps.LatLng(40.814,-73.6081);
  var myOptions = {
    zoom: 4,
    center: myLatlng,
    mapTypeId: google.maps.MapTypeId.ROADMAP
  }

  map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
	
  var image = 'blue-dot.png';
  

  for (var i = 0; i < ns.length; i++) {
    var node = ns[i];
    var location = new google.maps.LatLng(node[2], node[3]);
    var marker = new google.maps.Marker({
        position: location,
        icon: image,
        map: map,
    });
    marker.setTitle("NSid:" + node[0] + "  Name: " + node[1]);
    attachSecretMessage2(marker, node[0], node[1]);
    
  }

  var lns = [
['planetlab3.rutgers.edu', 40.4896, -74.4082, 'boot', 1, 'planetlab2.georgetown.edu', 1]
,['planetlab1.cs.colorado.edu', 40.0072, -105.262, 'boot', 2, 'kupl1.ittc.ku.edu', 2]
];

  for (var i = 0; i < lns.length; i++) {
	    var node = lns[i];
	    var location = new google.maps.LatLng(node[1], node[2]);
	    var marker = new google.maps.Marker({
	        position: location,
	        map: map,
	        animation: google.maps.Animation.DROP,
	    });

	    marker.setTitle("LNSid:" + node[4] + "  Name: " + node[0]);
	    var localnameserver = "LNSid: " + node[4];
	    var inf = node[3] + "<br/>Closest NS: " + node[6] + " (" + node[5] + ")";
	    attachSecretMessage(marker, node[0], localnameserver, inf);
	  }
}

// The five markers show a secret message when clicked
// but that message is not within the marker's instance data

function attachSecretMessage2(marker, id, name) {
  var infowindow = new google.maps.InfoWindow(
      { content: "<b>NSID:" + id + "</b>" + "<br/>Name: " + name
      });
  google.maps.event.addListener(marker, 'mouseover', function() {
    infowindow.open(map,marker);
  });
  google.maps.event.addListener(marker, 'mouseout', function() {
	    infowindow.close(map,marker);
  });
}

function attachSecretMessage(marker, message, id, bootState) {
  var infowindow = new google.maps.InfoWindow(
      { content: "<b>" + id + "</b>" + "<br/>Name: " + message + "<br/>Boot Status: " + bootState
      });
  google.maps.event.addListener(marker, 'mouseover', function() {
    infowindow.open(map,marker);
  });
  google.maps.event.addListener(marker, 'mouseout', function() {
	    infowindow.close(map,marker);
  });
}

</script>
</head>
<body onload="initialize()">
  <div id="map_canvas"></div>
</body>

</html>
